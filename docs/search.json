[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 CAMERA authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/development.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Development notes","text":"CAMERA (Cross Ancestral MEndelian RAndomization) method estimate causal effect exposure outcome using GWAS summary statistics different populations.CAMERA package includes three important components: Instrument selection multi-ancestral Mendelian randomization (MR) analysis Causal inference across multi-ancestral populations using structural equation model (SEM) Identification pleiotropic effects across multiple ancestral populations step documented documentation. following analyses run within couple minutes, depending internet speed traffic IEU GWAS database servers experiencing.","code":""},{"path":"/articles/development.html","id":"installation","dir":"Articles","previous_headings":"Background","what":"Installation","title":"Development notes","text":"install CAMERA: load R session","code":"install.packages(\"remotes\") remotes::install_github(\"universe77/CAMERA\") library(CAMeRa)"},{"path":"/articles/development.html","id":"data-setup","dir":"Articles","previous_headings":"Background","what":"Data setup","title":"Development notes","text":"CAMERA begins choosing exposure outcome hypothesis can tested multi-ancestral populations. , estimating causal effect body mass index (BMI) coronary heart disease (CHD) European ancestry (EUR) East Asian ancestry (EAS). Summary statistics data can extracted IEU GWAS database using TwoSampleMR package. list available traits can obtained using: can also browse available traits : https://gwas.mrcieu.ac.uk/ obtain study IDs exposure outcome, open R6 class environment run CAMERA. minimum information required CAMERA following: Summary statistics exposure outcome Population information Plink (ver.1.90) LD reference data Plink (ver.1.90) LD reference data required identify instruments can used populations. LD reference data can accessed : http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz Make sure exposures/outcomes matched across populations. Population 1 2 exposure-outcome pair. Also, instrument-trait associations consistent populations (e.g. similar SNP-BMI association EUR SNP-BMI assocation EAS). can check follows: value closes 1 indicates instrument-trait associations consistent populations. values low high, recommended use available instruments traits.","code":"traits <- TwoSampleMR::available_outcomes() # Need to specify path to plink and LD reference data here. # The following exposures and the outcomes will be used: Exposures: BMI (EUR, EAS); Outcomes: CHD (EUR, EAS) if (!requireNamespace(\"genetics.binaRies\", quietly = TRUE)) {   print(\"Package \\\"genetics.binaRies\\\" must be installed to run this chunk.\")   knitr::knit_exit() } else {   x <- CAMERA$new(     exposure_ids=c(\"ieu-a-2\", \"bbj-a-1\"),      outcome_ids=c(\"ieu-a-7\", \"bbj-a-109\"),      pops = c(\"EUR\", \"EAS\"),     bfiles=c(\"/Users/yc16575/OneDrive - University of Bristol/EUR\", \"/Users/yc16575/OneDrive - University of Bristol/EAS\"),              plink = genetics.binaRies::get_plink_binary(),           radius=50000,      clump_pop=\"EAS\"     ) } x$check_phenotypes(ids=x$exposure_ids) x$check_phenotypes(ids=x$outcome_ids)"},{"path":"/articles/development.html","id":"running-camera","dir":"Articles","previous_headings":"Background","what":"Running CAMERA","title":"Development notes","text":"can now perform analysis, following: Extract instruments exposures Check validity instruments across populations (Standardise/scale data necessary) Extract new instruments based LD information fine-mapping Extract instruments outcomes Harmonise exposure data outcome data Perform MR using SEM","code":""},{"path":"/articles/development.html","id":"step-by-step-analysis","dir":"Articles","previous_headings":"Background","what":"Step by step analysis","title":"Development notes","text":"See ?CAMERA options parameters analysis.","code":""},{"path":"/articles/development.html","id":"step-1--extract-instruments-for-the-exposures-from-each-pouplation","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 1. Extract instruments for the exposures from each pouplation","title":"Development notes","text":"returns set LD clumped SNPs GWAS significant BMI (raw instruments). following function identifies SNPs strong associations exposure population. method instrument extraction multivariable MR. data frame extracted instruments stored x$instrument_raw","code":"x$extract_instruments() head(x$instrument_raw)"},{"path":"/articles/development.html","id":"step-2--check-the-validity-of-the-instruments","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 2. Check the validity of the instruments","title":"Development notes","text":"important ensure instruments exposure valid across populations. instruments exposure trait identified population, can assess specificity instruments. following functions estimates heterogeneity instruments calculates fraction instruments (obtained Step 1) replicated populations. correct winner’s curse:","code":"x$instrument_heterogeneity(x$instrument_raw) x$estimate_instrument_specificity(x$instrument_raw, alpha = \"bonferroni\") x$estimate_instrument_specificity(x$instrument_raw, alpha = \"bonferroni\", winnerscurse=TRUE)"},{"path":"/articles/development.html","id":"step-3--extract-new-instruments-based-on-ld-information-and-fine-mapping","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 3. Extract new instruments based on LD information and fine-mapping","title":"Development notes","text":"Cross/Multi-ancestral MR important ensure genetic structures populations properly considered. following functions identify new set SNPs largest effect exposure, considering LD patterns. cases strongly associated SNPs available exactly position, function searches alternative SNPs located near original SNP show largest effect size magnitude (MaxZ method). data frame extracted instruments stored x$instrument_maxz Check replication fraction populations (instrument_maxz). Also, instruments can obtained using fine mapping method. Extracted instruments stored x$instrument_susie x$instrument_susie","code":"# Identify genomic regions that include the raw instruments (x$instrument_raw) suppressMessages(x$extract_instrument_regions()) # Extract instrument from identified region by searching across region for best associations x$scan_regional_instruments() # Plot regions and their region-selected instruments x$plot_regional_instruments(instruments=x$instrument_maxz) # Estimate what fraction of the region-selected instruments we'd expect to replicate x$instrument_heterogeneity(x$instrument_raw) x$estimate_instrument_specificity(x$instrument_raw, alpha = \"bonferroni\", winnerscurse = TRUE) # Calculate LD matrix for the whole regions that include the raw instruments x$regional_ld_matrices() # Run Susie x$susie_finemap_regions() # Run PAINTOR x$paintor_finemap_regions(PAINTOR=\"/user/work/yc16575/PAINTOR_V3.0/PAINTOR\", workdir=tempdir())"},{"path":"/articles/development.html","id":"step-4--extract-instruments-for-the-outcomes","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 4. Extract instruments for the outcomes","title":"Development notes","text":"instruments exposure trait specified, variants need extracted outcome trait. can also specify p-value thresholds.","code":"# Get outcome data for a particular set of instruments and run SEM model  x$make_outcome_data(exp=x$instrument_raw, p_exp=1) head(x$instrument_outcome)"},{"path":"/articles/development.html","id":"step-5--harmonise-the-exposure-data-and-the-outcome-data","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 5. Harmonise the exposure data and the outcome data","title":"Development notes","text":"creates new data frame exposure data outcome data combined (e.g. exposure-outcome EUR EAS).","code":"x$harmonised_dat(exp=x$instrument_raw, out=x$instrument_outcome) head(x$harmonised_dat_sem)"},{"path":"/articles/development.html","id":"step-6--perform-mr-using-genomic-structural-equation-model-mr-sem","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Step 6. Perform MR using genomic structural equation model (MR-SEM)","title":"Development notes","text":"can also perform MR-SEM using instruments Step 3.","code":"x$perform_basic_sem() # Standardise the betas and SEs if required x$make_outcome_data(exp=x$instrument_maxz, p_exp=1) head(x$instrument_outcome) x$harmonised_dat(exp=x$instrument_maxz, out=x$instrument_outcome) head(x$harmonised_dat_sem) x$perform_basic_sem()"},{"path":"/articles/development.html","id":"standardisation-scaling","dir":"Articles","previous_headings":"Background > Step by step analysis","what":"Standardisation / scaling","title":"Development notes","text":"units exposures/outcomes different across populations, run: Note standardisation required effect size SNP-trait unit SD log odds. cases SNP-exposure SNP-outcome association shows substantial difference population, scale beta estimates. can check specificity instruments using: can also make harmonised data standaridisation / scaling:","code":"x$standardise_data(dat=x$instrument_raw, standardise_unit=TRUE, standardise_scale=FALSE) head(x$standardised_instrument_raw) x$standardise_data(dat=x$instrument_outcome, standardise_unit=TRUE, standardise_scale=FALSE) head(x$standardised_instrument_outcome) x$standardise_data(dat=x$instrument_raw, standardise_unit=TRUE, standardise_scale=TRUE) head(x$standardised_instrument_raw) x$standardise_data(dat=x$instrument_outcome, standardise_unit=TRUE, standardise_scale=FALSE) head(x$standardised_outcome) x$instrument_heterogeneity(x$standardised_instrument_raw) x$estimate_instrument_specificity(x$standardised_instrument_raw, alpha = \"bonferroni\", winnerscurse=TRUE) x$harmonised_dat(exp=x$standardised_instrument_raw, out=x$standardised_outcome) head(x$harmonised_dat_sem)"},{"path":"/articles/import-local.html","id":"generating-the-data-manually","dir":"Articles","previous_headings":"","what":"Generating the data manually","title":"Import to CAMERA from local data","text":"need supply following data: instrument_raw = data frame pooled instruments across ancestries, extracted ancestry exposure traits. Optionally also provide outcome traits. instrument_outcome = instruments instrument_raw extracted outcome datasets instrument_regions = named list data frames length number unique instruments instrument_raw. Names item instruments. item list regional extracts around instrument population exposure study. instrument_outcome_regions = outcome datasets. Examples datasets can seen following file: example scripts data generated see https://github.com/yoonsucho/CAMERA_analysis/tree/main/scripts/ldl_stroke_analysis","code":"load(system.file(package=\"CAMeRa\", \"extdata/example-local.rdata\")) instrument_raw #> # A tibble: 45 × 14 #>      chr  position   eaf    beta      se        p ea    nea   rsid   trait pop   #>    <int>     <dbl> <dbl>   <dbl>   <dbl>    <dbl> <chr> <chr> <chr>  <chr> <chr> #>  1     3 122285218 0.224  0.0204 0.00583 4.69e- 4 C     CT    3:122… LDL   AFR   #>  2     3 122285218 0.438  0.0198 0.00542 2.52e- 4 C     CT    3:122… LDL   EAS   #>  3     3 122285218 0.302  0.0190 0.00166 2.66e-30 C     CT    3:122… LDL   EUR   #>  4     3 122285218 0.237  0.0139 0.00808 8.45e- 2 C     CT    3:122… LDL   AMR   #>  5     3 122285218 0.296  0.0154 0.00778 4.75e- 2 C     CT    3:122… LDL   SAS   #>  6     5 139567696 0.244 -0.0127 0.0172  4.62e- 1 G     T     5:139… LDL   AFR   #>  7     5 139567696 0.213 -0.0130 0.00192 1.10e-11 G     T     5:139… LDL   EUR   #>  8     6  27067657 0.989  0.0172 0.0222  4.37e- 1 A     T     6:270… LDL   AFR   #>  9     6  27067657 0.924  0.0325 0.00268 7.70e-34 A     T     6:270… LDL   EUR   #> 10     6  27067657 0.978  0.0558 0.0242  2.12e- 2 A     T     6:270… LDL   AMR   #> # ℹ 35 more rows #> # ℹ 3 more variables: id <chr>, nstudies <int>, target_trait <chr> instrument_outcome #> # A tibble: 15 × 14 #>      chr  position    eaf    beta     se       p ea    nea   rsid    trait pop   #>    <int>     <dbl>  <dbl>   <dbl>  <dbl>   <dbl> <chr> <chr> <chr>   <chr> <chr> #>  1     5 139567696 0.230   0.0069 0.008  0.387   G     T     5:1395… Stro… EUR   #>  2     5 139567696 0.247  -0.0483 0.0385 0.209   G     T     5:1395… Stro… AFR   #>  3     5 139567696 0.262   0.0183 0.0831 0.826   G     T     5:1395… Stro… AMR   #>  4     6  27067657 0.928  -0.0011 0.0132 0.934   A     T     6:2706… Stro… EUR   #>  5     6  27067657 0.975   0.212  0.219  0.333   A     T     6:2706… Stro… AMR   #>  6     6 161010118 0.936  -0.0427 0.0136 0.00177 A     G     6:1610… Stro… EUR   #>  7     6 161010118 0.963  -0.0934 0.171  0.584   A     G     6:1610… Stro… AMR   #>  8     7 137562744 0.0201  0.0259 0.0602 0.668   C     G     7:1375… Stro… EAS   #>  9     7 137562744 0.132   0.0945 0.0417 0.0234  C     G     7:1375… Stro… AFR   #> 10     7 143092269 0.0635  0.0158 0.014  0.257   A     G     7:1430… Stro… EUR   #> 11     7 143092269 0.0781  0.025  0.0765 0.743   A     G     7:1430… Stro… SAS   #> 12    16  72912880 0.957   0.0117 0.0194 0.547   A     G     16:729… Stro… EUR   #> 13    16  72912880 0.982  -0.225  0.183  0.219   A     G     16:729… Stro… SAS   #> 14    19  33864260 0.0307  0.0046 0.0192 0.813   A     G     19:338… Stro… EUR   #> 15    19  33864260 0.0521 -0.0669 0.0924 0.469   A     G     19:338… Stro… SAS   #> # ℹ 3 more variables: id <chr>, nstudies <int>, target_trait <chr> instrument_regions[[1]] #> $`LDL AFR` #> # A tibble: 2,827 × 12 #>      chr  position    eaf     beta      se     p ea    nea   rsid    trait pop   #>    <int>     <dbl>  <dbl>    <dbl>   <dbl> <dbl> <chr> <chr> <chr>   <chr> <chr> #>  1     3 121981372 0.984   0.0232  0.0204  0.256 C     T     3:1219… LDL   AFR   #>  2     3 121981609 0.0346  0.0189  0.0134  0.158 A     G     3:1219… LDL   AFR   #>  3     3 121981619 0.146   0.00208 0.00690 0.763 G     T     3:1219… LDL   AFR   #>  4     3 121981629 0.978  -0.00525 0.0167  0.754 A     G     3:1219… LDL   AFR   #>  5     3 121981835 0.823  -0.00165 0.00633 0.794 C     G     3:1219… LDL   AFR   #>  6     3 121981836 0.172   0.00212 0.00645 0.742 A     G     3:1219… LDL   AFR   #>  7     3 121982002 0.987  -0.00833 0.0215  0.699 C     T     3:1219… LDL   AFR   #>  8     3 121982338 0.178   0.00148 0.00632 0.814 G     T     3:1219… LDL   AFR   #>  9     3 121983322 0.818  -0.00143 0.00626 0.819 C     T     3:1219… LDL   AFR   #> 10     3 121983551 0.941  -0.00517 0.0108  0.631 C     T     3:1219… LDL   AFR   #> # ℹ 2,817 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`LDL AMR` #> # A tibble: 2,084 × 12 #>      chr  position    eaf     beta      se       p ea    nea   rsid  trait pop   #>    <int>     <dbl>  <dbl>    <dbl>   <dbl>   <dbl> <chr> <chr> <chr> <chr> <chr> #>  1     3 121981215 0.855   0.0303  0.0108  0.00521 A     G     3:12… LDL   AMR   #>  2     3 121981609 0.106   0.0160  0.0111  0.15    A     G     3:12… LDL   AMR   #>  3     3 121981619 0.2     0.0148  0.00988 0.135   G     T     3:12… LDL   AMR   #>  4     3 121981835 0.969  -0.0206  0.0235  0.381   C     G     3:12… LDL   AMR   #>  5     3 121981836 0.203   0.0119  0.00983 0.227   A     G     3:12… LDL   AMR   #>  6     3 121982338 0.0316  0.0184  0.0234  0.432   G     T     3:12… LDL   AMR   #>  7     3 121983322 0.968  -0.0192  0.0232  0.408   C     T     3:12… LDL   AMR   #>  8     3 121983607 0.76    0.0192  0.00919 0.0371  C     T     3:12… LDL   AMR   #>  9     3 121983805 0.795  -0.0150  0.00850 0.0775  C     T     3:12… LDL   AMR   #> 10     3 121984020 0.977   0.00998 0.0233  0.669   C     T     3:12… LDL   AMR   #> # ℹ 2,074 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`LDL EAS` #> # A tibble: 1,646 × 12 #>      chr  position    eaf    beta      se       p ea    nea   rsid   trait pop   #>    <int>     <dbl>  <dbl>   <dbl>   <dbl>   <dbl> <chr> <chr> <chr>  <chr> <chr> #>  1     3 121981609 0.0257 -0.0237 0.0160  0.14    A     G     3:121… LDL   EAS   #>  2     3 121981835 0.983  -0.0426 0.0195  0.0294  C     G     3:121… LDL   EAS   #>  3     3 121982338 0.017   0.0426 0.0195  0.0289  G     T     3:121… LDL   EAS   #>  4     3 121983322 0.983  -0.0425 0.0195  0.0288  C     T     3:121… LDL   EAS   #>  5     3 121983607 0.975   0.0293 0.0163  0.0727  C     T     3:121… LDL   EAS   #>  6     3 121984021 0.417   0.0154 0.00512 0.00261 A     G     3:121… LDL   EAS   #>  7     3 121984792 0.0253 -0.0281 0.0158  0.0758  A     G     3:121… LDL   EAS   #>  8     3 121985083 0.0253 -0.0282 0.0158  0.0748  A     AG    3:121… LDL   EAS   #>  9     3 121985131 0.984  -0.0435 0.0200  0.0296  A     G     3:121… LDL   EAS   #> 10     3 121985345 0.539  -0.0150 0.00503 0.0029  C     T     3:121… LDL   EAS   #> # ℹ 1,636 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`LDL EUR` #> # A tibble: 2,233 × 12 #>      chr  position    eaf     beta      se       p ea    nea   rsid  trait pop   #>    <int>     <dbl>  <dbl>    <dbl>   <dbl>   <dbl> <chr> <chr> <chr> <chr> <chr> #>  1     3 121981609 0.129   6.03e-3 0.00208 3.71e-3 A     G     3:12… LDL   EUR   #>  2     3 121981619 0.356   6.02e-4 0.00146 6.81e-1 G     T     3:12… LDL   EUR   #>  3     3 121981835 0.955   6.87e-3 0.00342 4.46e-2 C     G     3:12… LDL   EUR   #>  4     3 121981836 0.356   6.09e-4 0.00146 6.78e-1 A     G     3:12… LDL   EUR   #>  5     3 121982338 0.0448 -6.78e-3 0.00342 4.75e-2 G     T     3:12… LDL   EUR   #>  6     3 121983322 0.955   6.80e-3 0.00342 4.65e-2 C     T     3:12… LDL   EUR   #>  7     3 121983607 0.86    7.87e-3 0.00202 1   e-4 C     T     3:12… LDL   EUR   #>  8     3 121983674 0.972  -1.62e-2 0.00440 2.38e-4 A     G     3:12… LDL   EUR   #>  9     3 121983805 0.644  -6.39e-4 0.00146 6.62e-1 C     T     3:12… LDL   EUR   #> 10     3 121984020 0.976  -1.46e-3 0.00464 7.53e-1 C     T     3:12… LDL   EUR   #> # ℹ 2,223 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`LDL SAS` #> # A tibble: 1,875 × 12 #>      chr  position    eaf      beta      se      p ea    nea   rsid  trait pop   #>    <int>     <dbl>  <dbl>     <dbl>   <dbl>  <dbl> <chr> <chr> <chr> <chr> <chr> #>  1     3 121981609 0.193  -0.000939 0.00906 0.917  A     G     3:12… LDL   SAS   #>  2     3 121981619 0.234   0.00438  0.00837 0.601  G     T     3:12… LDL   SAS   #>  3     3 121981835 0.952   0.0186   0.0166  0.26   C     G     3:12… LDL   SAS   #>  4     3 121981836 0.234   0.00416  0.00836 0.619  A     G     3:12… LDL   SAS   #>  5     3 121982338 0.0479 -0.0177   0.0164  0.28   G     T     3:12… LDL   SAS   #>  6     3 121983322 0.952   0.0177   0.0164  0.281  C     T     3:12… LDL   SAS   #>  7     3 121983607 0.85    0.00333  0.00985 0.735  C     T     3:12… LDL   SAS   #>  8     3 121983805 0.766  -0.00409  0.00835 0.624  C     T     3:12… LDL   SAS   #>  9     3 121984020 0.985   0.0239   0.0293  0.415  C     T     3:12… LDL   SAS   #> 10     3 121984021 0.0591  0.0321   0.0150  0.0316 A     G     3:12… LDL   SAS   #> # ℹ 1,865 more rows #> # ℹ 1 more variable: id <chr> instrument_outcome_regions[[1]] #> $`Stroke African American or Afro-Caribbean` #> # A tibble: 1,935 × 12 #>      chr  position    eaf    beta     se      p ea    nea   rsid     trait pop   #>    <int>     <dbl>  <dbl>   <dbl>  <dbl>  <dbl> <chr> <chr> <chr>    <chr> <chr> #>  1     3 122289921 0.387  -0.0073 0.0302 0.808  C     T     3:12228… Stro… AFR   #>  2     3 122108718 0.345  -0.0224 0.0297 0.451  G     T     3:12210… Stro… AFR   #>  3     3 122356077 0.153   0.0322 0.0422 0.445  G     T     3:12235… Stro… AFR   #>  4     3 122125052 0.309   0.0319 0.0306 0.297  A     G     3:12212… Stro… AFR   #>  5     3 122467637 0.0267  0.176  0.103  0.0864 C     T     3:12246… Stro… AFR   #>  6     3 122297742 0.323  -0.0286 0.0303 0.344  A     G     3:12229… Stro… AFR   #>  7     3 122365670 0.885  -0.0087 0.0479 0.855  C     G     3:12236… Stro… AFR   #>  8     3 122214612 0.0976 -0.0716 0.0484 0.139  C     T     3:12221… Stro… AFR   #>  9     3 122201610 0.0948 -0.0072 0.0483 0.882  C     G     3:12220… Stro… AFR   #> 10     3 122376850 0.691   0.0424 0.0305 0.165  A     G     3:12237… Stro… AFR   #> # ℹ 1,925 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`Stroke Hispanic or Latin American` #> # A tibble: 1,566 × 12 #>      chr  position    eaf    beta     se      p ea    nea   rsid     trait pop   #>    <int>     <dbl>  <dbl>   <dbl>  <dbl>  <dbl> <chr> <chr> <chr>    <chr> <chr> #>  1     3 122289921 0.382  -0.101  0.0794 0.204  C     T     3:12228… Stro… AMR   #>  2     3 122108718 0.174   0.0473 0.0737 0.521  G     T     3:12210… Stro… AMR   #>  3     3 122125052 0.295  -0.0998 0.0586 0.0887 A     G     3:12212… Stro… AMR   #>  4     3 122297742 0.316   0.125  0.0642 0.0522 A     G     3:12229… Stro… AMR   #>  5     3 122365670 0.835   0.0308 0.0833 0.711  C     G     3:12236… Stro… AMR   #>  6     3 122214612 0.0209  0.111  0.256  0.664  C     T     3:12221… Stro… AMR   #>  7     3 122201610 0.132  -0.0104 0.0806 0.897  C     G     3:12220… Stro… AMR   #>  8     3 122034854 0.426  -0.0195 0.0563 0.729  A     G     3:12203… Stro… AMR   #>  9     3 122268506 0.118  -0.0509 0.0873 0.560  C     T     3:12226… Stro… AMR   #> 10     3 122273816 0.516  -0.0404 0.0756 0.593  A     G     3:12227… Stro… AMR   #> # ℹ 1,556 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`Stroke East Asian` #> # A tibble: 1,351 × 12 #>      chr  position    eaf    beta     se       p ea    nea   rsid    trait pop   #>    <int>     <dbl>  <dbl>   <dbl>  <dbl>   <dbl> <chr> <chr> <chr>   <chr> <chr> #>  1     3 122289921 0.601  -0.0027 0.011  0.807   C     T     3:1222… Stro… EAS   #>  2     3 122024691 0.0338 -0.0287 0.03   0.338   A     T     3:1220… Stro… EAS   #>  3     3 122108718 0.0281 -0.0972 0.0327 0.00299 G     T     3:1221… Stro… EAS   #>  4     3 122125052 0.588   0.0146 0.0096 0.130   A     G     3:1221… Stro… EAS   #>  5     3 122297742 0.250  -0.0051 0.011  0.644   A     G     3:1222… Stro… EAS   #>  6     3 122201610 0.0788 -0.0304 0.0205 0.138   C     G     3:1222… Stro… EAS   #>  7     3 122376850 0.346   0.0151 0.0101 0.135   A     G     3:1223… Stro… EAS   #>  8     3 122034854 0.099   0.0019 0.016  0.905   A     G     3:1220… Stro… EAS   #>  9     3 122268506 0.439   0.0193 0.0097 0.0479  C     T     3:1222… Stro… EAS   #> 10     3 122273816 0.353  -0.0072 0.0101 0.472   A     G     3:1222… Stro… EAS   #> # ℹ 1,341 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`Stroke European` #> # A tibble: 1,489 × 12 #>      chr  position   eaf    beta     se      p ea    nea   rsid      trait pop   #>    <int>     <dbl> <dbl>   <dbl>  <dbl>  <dbl> <chr> <chr> <chr>     <chr> <chr> #>  1     3 122289921 0.286  0.0039 0.0081 0.629  C     T     3:122289… Stro… EUR   #>  2     3 122108718 0.143 -0.0035 0.0094 0.709  G     T     3:122108… Stro… EUR   #>  3     3 122125052 0.437 -0.0122 0.0065 0.059  A     G     3:122125… Stro… EUR   #>  4     3 122297742 0.24  -0.0084 0.0079 0.286  A     G     3:122297… Stro… EUR   #>  5     3 122365670 0.757 -0.0168 0.0075 0.0264 C     G     3:122365… Stro… EUR   #>  6     3 122201610 0.138 -0.0005 0.0096 0.960  C     G     3:122201… Stro… EUR   #>  7     3 122376850 0.748  0.0103 0.0076 0.175  A     G     3:122376… Stro… EUR   #>  8     3 122034854 0.281  0.0026 0.0077 0.739  A     G     3:122034… Stro… EUR   #>  9     3 122268506 0.165 -0.0018 0.0086 0.837  C     T     3:122268… Stro… EUR   #> 10     3 122273816 0.430  0.0097 0.0066 0.145  A     G     3:122273… Stro… EUR   #> # ℹ 1,479 more rows #> # ℹ 1 more variable: id <chr> #>  #> $`Stroke South Asian` #> # A tibble: 561 × 12 #>      chr  position    eaf    beta     se      p ea    nea   rsid     trait pop   #>    <int>     <dbl>  <dbl>   <dbl>  <dbl>  <dbl> <chr> <chr> <chr>    <chr> <chr> #>  1     3 122289921 0.305  -0.066  0.0504 0.190  C     T     3:12228… Stro… SAS   #>  2     3 122356077 0.0455  0.0271 0.109  0.804  G     T     3:12235… Stro… SAS   #>  3     3 122297445 0.802  -0.0272 0.0512 0.595  A     T     3:12229… Stro… SAS   #>  4     3 122292451 0.0652  0.135  0.102  0.185  A     G     3:12229… Stro… SAS   #>  5     3 122321980 0.0313  0.256  0.120  0.0339 A     G     3:12232… Stro… SAS   #>  6     3 122177260 0.953   0.0188 0.103  0.855  C     T     3:12217… Stro… SAS   #>  7     3 122147542 0.0795  0.0231 0.0749 0.757  A     G     3:12214… Stro… SAS   #>  8     3 122201061 0.0566 -0.0094 0.0958 0.922  A     C     3:12220… Stro… SAS   #>  9     3 122089025 0.927  -0.019  0.0774 0.807  A     G     3:12208… Stro… SAS   #> 10     3 122408098 0.0196  0.0389 0.147  0.791  C     T     3:12240… Stro… SAS   #> # ℹ 551 more rows #> # ℹ 1 more variable: id <chr>"},{"path":"/articles/import-local.html","id":"generating-the-data-using-camera_local","dir":"Articles","previous_headings":"","what":"Generating the data using CAMERA_local","title":"Import to CAMERA from local data","text":"developed separate set functions organise data text files generate data . read files specified metadata attempt arrange data described , generating localdata$instrument_raw, localdata$instrument_outcome etc. can generate CAMERA object e.g.","code":"metadata <- readRDS(system.file(package=\"CAMeRa\", \"extdata/example-metadata.rds\")) metadata #> # A tibble: 10 × 16 #>    what     pop   trait  id          n rsid_col chr_col pos_col eaf_col beta_col #>    <chr>    <chr> <chr>  <chr>   <dbl>    <dbl>   <dbl>   <dbl>   <dbl>    <dbl> #>  1 exposure AFR   LDL    LDL A… 9.11e4        1       2       3       8        9 #>  2 exposure EAS   LDL    LDL E… 7.98e4        1       2       3       8        9 #>  3 exposure EUR   LDL    LDL E… 9.00e5        1       2       3       8        9 #>  4 exposure AMR   LDL    LDL A… 4.48e4        1       2       3       8        9 #>  5 exposure SAS   LDL    LDL S… 3.04e4        1       2       3       8        9 #>  6 outcome  EUR   Stroke Strok… 1.31e6       NA       1       2       3        4 #>  7 outcome  EAS   Stroke Strok… 2.65e5       NA       1       2       3        4 #>  8 outcome  AFR   Stroke Strok… 2.40e4       NA       1       2       3        4 #>  9 outcome  AMR   Stroke Strok… 5.66e3       NA       1       2       3        4 #> 10 outcome  SAS   Stroke Strok… 1.13e4       NA       1       2       3        4 #> # ℹ 6 more variables: se_col <dbl>, pval_col <dbl>, ea_col <dbl>, oa_col <dbl>, #> #   fn <chr>, units <chr> ld_ref <- dplyr::tibble(     pop = unique(metadata$pop),     bfile = file.path(\"path/to/plink_files/\", pop) ) ld_ref #> # A tibble: 5 × 2 #>   pop   bfile                    #>   <chr> <chr>                    #> 1 AFR   path/to/plink_files//AFR #> 2 EAS   path/to/plink_files//EAS #> 3 EUR   path/to/plink_files//EUR #> 4 AMR   path/to/plink_files//AMR #> 5 SAS   path/to/plink_files//SAS localdata <- CAMERA_local$new(metadata = metadata, ld_ref = ld_ref, plink_bin = \"path/to/plink\") localdata$organise() l <- CAMERA$new() l$import_from_local(   instrument_raw=instrument_raw,    instrument_outcome=instrument_outcome,    instrument_regions=instrument_regions,    instrument_outcome_regions=instrument_outcome_regions,    exposure_ids=unique(instrument_raw$id),    outcome_ids=unique(names(instrument_outcome_regions[[1]])) ) #> list()  l$instrument_heterogeneity() #> # A tibble: 14 × 9 #>    Reference Replication  nsnp agreement     se     pval      Q   Q_pval #>    <chr>     <chr>       <int>     <dbl>  <dbl>    <dbl>  <dbl>    <dbl> #>  1 LDL AFR   LDL EAS         3     1.06  0.371  4.27e- 3 14.5   6.99e- 4 #>  2 LDL AFR   LDL EUR         3     0.942 0.0207 0         0.168 9.19e- 1 #>  3 LDL AFR   LDL AMR         4     0.901 0.138  7.04e-11  1.77  6.22e- 1 #>  4 LDL AFR   LDL SAS         2     1.06  0.261  4.93e- 5  1.10  2.94e- 1 #>  5 LDL EAS   LDL AFR         3     0.656 0.125  1.41e- 7  2.11  3.49e- 1 #>  6 LDL EAS   LDL EUR         3     0.692 0.151  4.65e- 6 41.3   1.10e- 9 #>  7 LDL EAS   LDL AMR         3     0.793 0.175  6.20e- 6  0.399 8.19e- 1 #>  8 LDL EAS   LDL SAS         3     0.726 0.156  3.47e- 6  0.216 8.98e- 1 #>  9 LDL EUR   LDL AFR         8     0.990 0.117  2.62e-17  2.27  9.43e- 1 #> 10 LDL EUR   LDL EAS         5     1.07  0.235  5.06e- 6 14.3   6.36e- 3 #> 11 LDL EUR   LDL AMR        10     0.883 0.146  1.63e- 9 11.6   2.40e- 1 #> 12 LDL EUR   LDL SAS         8     0.835 0.189  1.02e- 5  9.85  1.97e- 1 #> 13 LDL AMR   LDL AFR         2     0.931 0.198  2.68e- 6  2.18  1.39e- 1 #> 14 LDL AMR   LDL EUR         2     1.02  0.148  5.49e-12 40.1   2.47e-10 #> # ℹ 1 more variable: I2 <dbl>"},{"path":"/articles/tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Tutorial","text":"software attempts bring together various tools improve cross-ancestry Mendelian randomisation. use example performing analysis BMI coronary heart disease across four major ancestral groups. Overview: Initialise data Check phenotype scales across ancestries Extract instruments Evaluate instrument heterogeneity across populations Extract outcome data Harmonise exposure outcome data Perform analysis using raw instruments Perform regional scan obtain LD agnostic instruments Re-perform analysis using regional instruments Evaluate similarity pleiotropy across ancestry Evaluate similarity instrument-exposure associations Use cross-population instrument-exposure heterogeneity MR GxE framework estimate pleiotropy distributions Saving loading data","code":""},{"path":"/articles/tutorial.html","id":"initialise-data","dir":"Articles","previous_headings":"","what":"Initialise data","title":"Tutorial","text":"CAMeRa begins choosing exposure outcome hypothesis can tested multi-ancestral populations. , estimating causal effect body mass index (BMI) coronary heart disease (CHD) European (EUR), East Asian (EAS), African (AFR) South Asian (SAS) ancestries. Summary statistics data can extracted IEU GWAS database using TwoSampleMR package. list available traits can obtained using: can also browse available traits : https://gwas.mrcieu.ac.uk/. Also see vignettes site can use local summary statistics instead. obtain study IDs exposure outcome, open R6 class environment run CAMERA. minimum information required CAMERA following: Summary statistics exposure outcome Population information Plink (ver.1.90) LD reference data Plink (ver.1.90) LD reference data required identify instruments can used populations. LD reference data can accessed : http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz.","code":"traits <- TwoSampleMR::available_outcomes() bfile_dir <- \"/path/to/ld_files\" x <- CAMERA$new(   exposure_ids=c(     \"ukb-e-23104_CSA\",      \"ukb-e-21001_AFR\",      \"ukb-b-19953\",      \"bbj-a-1\"   ),    outcome_ids=c(     \"ukb-e-411_CSA\",      \"ukb-e-411_AFR\",      \"ieu-a-7\",      \"bbj-a-109\"   ),    pops = c(\"SAS\", \"AFR\", \"EUR\", \"EAS\"),   bfiles=file.path(bfile_dir, c(\"SAS\", \"AFR\", \"EUR\", \"EAS\")),   plink = genetics.binaRies::get_plink_binary(),           radius=50000,    clump_pop=\"EUR\" ) x #> <CAMERA> #>   Public: #>     assign: function (...)  #>     bfiles: /path/to/ld_files/SAS /path/to/ld_files/AFR /path/to/ld_ ... #>     check_phenotypes: function (ids = self$exposure_ids)  #>     clone: function (deep = FALSE)  #>     clump_pop: EUR #>     cross_estimate: function (dat = self$harmonised_dat)  #>     estimate_instrument_heterogeneity_per_variant: function (dat = self$harmonised_dat)  #>     estimate_instrument_specificity: function (instrument, alpha = \"bonferroni\", winnerscurse = FALSE)  #>     expected_replications: NULL #>     exposure_ids: ukb-e-23104_CSA ukb-e-21001_AFR ukb-b-19953 bbj-a-1 #>     exposure_metadata: GwasInfo, data.frame #>     extract_instrument_regions: function (radius = self$radius, instrument_raw = self$instrument_raw,  #>     extract_instruments: function (exposure_ids = self$exposure_ids, ...)  #>     fema_regional_instruments: function (method = \"fema\", instrument_regions = self$instrument_regions,  #>     get_metadata: function (exposure_ids = self$exposure_ids, outcome_ids = self$outcome_ids)  #>     harmonise: function (exp = self$instrument_raw, out = self$instrument_outcome)  #>     harmonise_deprecated: function (exp = self$instrument_raw, out = self$instrument_outcome)  #>     harmonised_dat: NULL #>     harmonised_dat_sem: NULL #>     harmonised_data_check: NULL #>     import: function (x)  #>     import_from_local: function (instrument_raw, instrument_outcome, instrument_regions,  #>     initialize: function (exposure_ids = NULL, outcome_ids = NULL, pops = NULL,  #>     instrument_fema: NULL #>     instrument_fema_regions: NULL #>     instrument_heterogeneity: function (instrument = self$instrument_raw, alpha = \"bonferroni\",  #>     instrument_heterogeneity_per_variant: NULL #>     instrument_maxz: NULL #>     instrument_mscaviar: NULL #>     instrument_outcome: NULL #>     instrument_outcome_regions: NULL #>     instrument_paintor: NULL #>     instrument_raw: NULL #>     instrument_region_zscores: NULL #>     instrument_regions: NULL #>     instrument_specificity: NULL #>     instrument_specificity_summary: NULL #>     instrument_susie: NULL #>     ld_matrices: NULL #>     make_outcome_data: function (exp = self$instrument_raw, p_exp = 0.05/nrow(exp))  #>     mrgxe: function (dat = self$harmonised_dat, variant_list = subset(self$instrument_heterogeneity_per_variant,  #>     mrgxe_plot: function (mrgxe_res = self$mrgxe_res)  #>     mrgxe_plot_variant: function (variant = self$mrgxe_res %>% dplyr::filter(p.adjust(a_pval,  #>     mrgxe_res: NULL #>     mrres: NULL #>     MsCAVIAR_finemap_regions: function (region = self$instrument_regions, ld = self$ld_matrices,  #>     mscaviar_results: NULL #>     outcome_ids: ukb-e-411_CSA ukb-e-411_AFR ieu-a-7 bbj-a-109 #>     outcome_metadata: GwasInfo, data.frame #>     output: list #>     paintor_finemap_regions: function (region = self$instrument_regions, ld = self$ld_matrices,  #>     paintor_results: NULL #>     perform_basic_sem: function (harmonised_dat = self$harmonised_dat_sem)  #>     pleiotropy: function (harmonised_dat = self$harmonised_dat)  #>     pleiotropy_agreement: NULL #>     pleiotropy_deprecated: function (harmonised_dat = self$harmonised_dat_sem)  #>     pleiotropy_outliers: NULL #>     pleiotropy_Q_outliers: NULL #>     pleiotropy_specificity_deprecated: function (harmonised_dat = self$harmonised_dat_sem, sem_result = self$sem_result,  #>     plink: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resou ... #>     plot_cross_estimate: function (res = self$mrres, qj_alpha = 0.05)  #>     plot_pleiotropy: function (dat = self$pleiotropy_outliers)  #>     plot_pleiotropy_heterogeneity: function (dat = self$pleiotropy_Q_outliers, pthresh = 0.05)  #>     plot_regional_instruments: function (region, instrument_regions = self$instrument_regions,  #>     plot_regional_instruments_maxz: function (instrument_region_zscores = self$instrument_region_zscores,  #>     pops: SAS AFR EUR EAS #>     radius: 50000 #>     regional_ld_matrices: function (instrument_regions = self$instrument_regions, bfiles = self$bfiles,  #>     replication_evaluation: function (instrument = self$instrument_raw, ld = self$ld_matrices)  #>     runsem: function (model, data, modname)  #>     scan_regional_instruments: function (instrument_raw = self$instrument_raw, instrument_regions = self$instrument_regions)  #>     sem_result: NULL #>     set_summary: function ()  #>     source: OpenGWAS #>     standardise_data: function (dat = self$instrument_raw, standardise_unit = FALSE,  #>     standardised_instrument_maxz: NULL #>     standardised_instrument_mscaviar: NULL #>     standardised_instrument_paintor: NULL #>     standardised_instrument_raw: NULL #>     standardised_instrument_susie: NULL #>     standardised_outcome: NULL #>     summary: NULL #>     susie_finemap_regions: function (dat = self$instrument_regions, ld = self$ld_matrices)  #>     susie_results: NULL #>   Private: #>     allele_frequency: function (dat = dat)  #>     bootstrap: function (wr, wr.se, ivw, ivw.se, nboot = 1000)  #>     bootstrap_diff: function (nboot, slope, slope_se, b_out, b_out_se, b_exp, b_exp_se)  #>     greedy_remove: function (r, thresh)  #>     jackknife2: function (x, theta, ...)  #>     sd_standardise: function (dat = dat)  #>     susie_overlaps: function (su1, su2)"},{"path":"/articles/tutorial.html","id":"check-phenotype-scales-across-ancestries","dir":"Articles","previous_headings":"","what":"Check phenotype scales across ancestries","title":"Tutorial","text":"Make sure exposures/outcomes matched across populations. different populations exposure-outcome pair, exposure outcome traits measured way units. Also, instrument-trait associations consistent populations (e.g. similar SNP-BMI association EUR SNP-BMI assocation EAS). can check follows:","code":"x$check_phenotypes(ids=x$exposure_ids) x$check_phenotypes(ids=x$outcome_ids)"},{"path":"/articles/tutorial.html","id":"extract-instruments","dir":"Articles","previous_headings":"","what":"Extract instruments","title":"Tutorial","text":"can now perform analysis, following: Extract instruments exposures Check validity instruments across populations (Standardise/scale data necessary) Extract new instruments based LD information fine-mapping Extract instruments outcomes Harmonise exposure data outcome data Perform MR Note see ?CAMERA options parameters analysis. following function identifies SNPs strong associations exposure population. method instrument extraction multivariable MR. data frame extracted instruments stored x$instrument_raw","code":"x$extract_instruments() str(x$instrument_raw) #> 'data.frame':    1495 obs. of  14 variables: #>  $ rsid      : chr  \"1:2723214_A_C\" \"1:6657424_A_C\" \"1:11207269_C_T\" \"1:19934900_A_G\" ... #>  $ chr       : chr  \"1\" \"1\" \"1\" \"1\" ... #>  $ position  : int  2723214 6657424 11207269 19934900 23313353 33784146 39564930 47678458 49996959 66434743 ... #>  $ id        : chr  \"ukb-e-23104_CSA\" \"ukb-e-23104_CSA\" \"ukb-e-23104_CSA\" \"ukb-e-23104_CSA\" ... #>  $ beta      : num  -0.0266 -0.0235 0.0171 -0.0148 -0.0169 ... #>  $ se        : num  0.0154 0.0154 0.0192 0.0169 0.0146 ... #>  $ p         : num  0.0841 0.1262 0.3728 0.3823 0.2496 ... #>  $ ea        : chr  \"A\" \"A\" \"C\" \"A\" ... #>  $ nea       : chr  \"C\" \"C\" \"T\" \"G\" ... #>  $ eaf       : num  0.67 0.676 0.834 0.766 0.422 ... #>  $ units     : chr  \"NA\" \"NA\" \"NA\" \"NA\" ... #>  $ samplesize: num  8658 8658 8658 8658 8658 ... #>  $ method    : chr  \"raw\" \"raw\" \"raw\" \"raw\" ... #>  $ rsido     : chr  \"rs4648450\" \"rs3866805\" \"rs2791643\" \"rs61740466\" ..."},{"path":"/articles/tutorial.html","id":"evaluate-instrument-heterogeneity-across-populations","dir":"Articles","previous_headings":"","what":"Evaluate instrument heterogeneity across populations","title":"Tutorial","text":"important ensure instruments exposure valid across populations. instruments exposure trait identified population, can assess specificity instruments. following functions estimates heterogeneity instruments calculates fraction instruments (obtained Step 1) replicated populations.","code":"x$instrument_heterogeneity() #> # A tibble: 6 × 9 #>   Reference  Replication  nsnp agreement     se      pval    I2      Q    Q_pval #>   <chr>      <chr>       <int>     <dbl>  <dbl>     <dbl> <dbl>  <dbl>     <dbl> #> 1 ukb-b-199… ukb-e-2310…   367     0.603 0.0505 7.52e- 33 0.123  418.  3.06e-  2 #> 2 ukb-b-199… ukb-e-2100…   367     0.417 0.0703 3.14e-  9 0.143  428.  1.36e-  2 #> 3 ukb-b-199… bbj-a-1       367     0.580 0.0219 7.07e-155 0.658 1074.  8.47e- 71 #> 4 bbj-a-1    ukb-e-2310…    45     0.642 0.111  7.04e-  9 0.415   77.0 1.54e-  3 #> 5 bbj-a-1    ukb-e-2100…    45     0.415 0.152  6.49e-  3 0.426   78.4 1.10e-  3 #> 6 bbj-a-1    ukb-b-19953    45     0.860 0.0512 2.29e- 63 0.947  842.  4.23e-148 x$estimate_instrument_specificity(instrument=x$instrument_raw) #> Checking ukb-e-23104_CSA against ukb-e-21001_AFR #> Checking ukb-e-23104_CSA against ukb-b-19953 #> Checking ukb-e-23104_CSA against bbj-a-1 #> Checking ukb-e-21001_AFR against ukb-e-23104_CSA #> Checking ukb-e-21001_AFR against ukb-b-19953 #> Checking ukb-e-21001_AFR against bbj-a-1 #> Checking ukb-b-19953 against ukb-e-23104_CSA #> Checking ukb-b-19953 against ukb-e-21001_AFR #> Checking ukb-b-19953 against bbj-a-1 #> Checking bbj-a-1 against ukb-e-23104_CSA #> Checking bbj-a-1 against ukb-e-21001_AFR #> Checking bbj-a-1 against ukb-b-19953 #>          discovery     replication nsnp  metric    datum       value #> 1  ukb-e-21001_AFR ukb-e-23104_CSA    1 P-value Expected   0.9987959 #> 2  ukb-e-21001_AFR ukb-e-23104_CSA    1 P-value Observed   1.0000000 #> 3  ukb-e-21001_AFR ukb-e-23104_CSA    1    Sign Expected   0.9999995 #> 4  ukb-e-21001_AFR ukb-e-23104_CSA    1    Sign Observed   1.0000000 #> 5  ukb-e-21001_AFR     ukb-b-19953    1 P-value Expected   1.0000000 #> 6  ukb-e-21001_AFR     ukb-b-19953    1 P-value Observed   1.0000000 #> 7  ukb-e-21001_AFR     ukb-b-19953    1    Sign Expected   0.9999995 #> 8  ukb-e-21001_AFR     ukb-b-19953    1    Sign Observed   1.0000000 #> 9  ukb-e-21001_AFR         bbj-a-1    1 P-value Expected   1.0000000 #> 10 ukb-e-21001_AFR         bbj-a-1    1 P-value Observed   1.0000000 #> 11 ukb-e-21001_AFR         bbj-a-1    1    Sign Expected   0.9999995 #> 12 ukb-e-21001_AFR         bbj-a-1    1    Sign Observed   1.0000000 #> 13     ukb-b-19953 ukb-e-23104_CSA  367 P-value Expected   1.7683672 #> 14     ukb-b-19953 ukb-e-23104_CSA  367 P-value Observed   2.0000000 #> 15     ukb-b-19953 ukb-e-23104_CSA  367    Sign Expected 306.2709020 #> 16     ukb-b-19953 ukb-e-23104_CSA  367    Sign Observed 261.0000000 #> 17     ukb-b-19953 ukb-e-21001_AFR  367 P-value Expected   0.4150693 #> 18     ukb-b-19953 ukb-e-21001_AFR  367 P-value Observed   1.0000000 #> 19     ukb-b-19953 ukb-e-21001_AFR  367    Sign Expected 277.0372286 #> 20     ukb-b-19953 ukb-e-21001_AFR  367    Sign Observed 217.0000000 #> 21     ukb-b-19953         bbj-a-1  367 P-value Expected 125.8672314 #> 22     ukb-b-19953         bbj-a-1  367 P-value Observed  42.0000000 #> 23     ukb-b-19953         bbj-a-1  367    Sign Expected 362.4660856 #> 24     ukb-b-19953         bbj-a-1  367    Sign Observed 321.0000000 #> 25         bbj-a-1 ukb-e-23104_CSA   45 P-value Expected   1.4396361 #> 26         bbj-a-1 ukb-e-23104_CSA   45 P-value Observed   2.0000000 #> 27         bbj-a-1 ukb-e-23104_CSA   45    Sign Expected  41.3635330 #> 28         bbj-a-1 ukb-e-23104_CSA   45    Sign Observed  35.0000000 #> 29         bbj-a-1 ukb-e-21001_AFR   45 P-value Expected   0.2681076 #> 30         bbj-a-1 ukb-e-21001_AFR   45 P-value Observed   1.0000000 #> 31         bbj-a-1 ukb-e-21001_AFR   45    Sign Expected  38.0010867 #> 32         bbj-a-1 ukb-e-21001_AFR   45    Sign Observed  27.0000000 #> 33         bbj-a-1     ukb-b-19953   45 P-value Expected  44.3523980 #> 34         bbj-a-1     ukb-b-19953   45 P-value Observed  40.0000000 #> 35         bbj-a-1     ukb-b-19953   45    Sign Expected  44.9998612 #> 36         bbj-a-1     ukb-b-19953   45    Sign Observed  45.0000000 #>           pdiff #> 1  1.000000e+00 #> 2  1.000000e+00 #> 3  1.000000e+00 #> 4  1.000000e+00 #> 5  1.000000e+00 #> 6  1.000000e+00 #> 7  1.000000e+00 #> 8  1.000000e+00 #> 9  1.000000e+00 #> 10 1.000000e+00 #> 11 1.000000e+00 #> 12 1.000000e+00 #> 13 6.981287e-01 #> 14 6.981287e-01 #> 15 3.629548e-09 #> 16 3.629548e-09 #> 17 3.398606e-01 #> 18 3.398606e-01 #> 19 5.755367e-12 #> 20 5.755367e-12 #> 21 1.064999e-23 #> 22 1.064999e-23 #> 23 3.048804e-31 #> 24 3.048804e-31 #> 25 6.557071e-01 #> 26 6.557071e-01 #> 27 2.716399e-03 #> 28 2.716399e-03 #> 29 2.357876e-01 #> 30 2.357876e-01 #> 31 6.800783e-05 #> 32 6.800783e-05 #> 33 4.670267e-04 #> 34 4.670267e-04 #> 35 1.000000e+00 #> 36 1.000000e+00"},{"path":"/articles/tutorial.html","id":"extract-outcome-data","dir":"Articles","previous_headings":"","what":"Extract outcome data","title":"Tutorial","text":"","code":"x$make_outcome_data()"},{"path":"/articles/tutorial.html","id":"harmonise-exposure-and-outcome-data","dir":"Articles","previous_headings":"","what":"Harmonise exposure and outcome data","title":"Tutorial","text":"","code":"x$harmonise() #> # A tibble: 4 × 4 #>   pops  exposure_ids    outcome_ids   source   #>   <chr> <chr>           <chr>         <chr>    #> 1 SAS   ukb-e-23104_CSA ukb-e-411_CSA OpenGWAS #> 2 AFR   ukb-e-21001_AFR ukb-e-411_AFR OpenGWAS #> 3 EUR   ukb-b-19953     ieu-a-7       OpenGWAS #> 4 EAS   bbj-a-1         bbj-a-109     OpenGWAS #> 'data.frame':    1495 obs. of  4 variables: #>  $ SNP : chr  \"1:2723214_A_C\" \"1:6657424_A_C\" \"1:11207269_C_T\" \"1:19934900_A_G\" ... #>  $ pops: chr  \"SAS\" \"SAS\" \"SAS\" \"SAS\" ... #>  $ beta: num  -0.0266 -0.0235 0.0171 -0.0148 -0.0169 ... #>  $ se  : num  0.0154 0.0154 0.0192 0.0169 0.0146 ... #> NULL #> 'data.frame':    2434 obs. of  4 variables: #>  $ SNP : chr  \"1:11207269_C_T\" \"1:11207269_C_T\" \"1:11207269_C_T\" \"1:11207269_C_T\" ... #>  $ pops: chr  \"SAS\" \"AFR\" \"EUR\" \"EAS\" ... #>  $ beta: num  -0.06663 -0.09457 -0.00328 0.0234 0.00391 ... #>  $ se  : num  0.0594 0.0809 0.0112 0.0319 0.0457 ... #> NULL #> 'data.frame':    1477 obs. of  6 variables: #>  $ SNP   : chr  \"1:2723214_A_C\" \"1:6657424_A_C\" \"1:11207269_C_T\" \"1:19934900_A_G\" ... #>  $ pops  : chr  \"SAS\" \"SAS\" \"SAS\" \"SAS\" ... #>  $ beta.x: num  -0.0266 -0.0235 0.0171 -0.0148 -0.0169 ... #>  $ se.x  : num  0.0154 0.0154 0.0192 0.0169 0.0146 ... #>  $ beta.y: num  -0.0152 -0.0295 -0.0666 0.0603 0.0465 ... #>  $ se.y  : num  0.048 0.0479 0.0594 0.0527 0.0456 ... #> NULL"},{"path":"/articles/tutorial.html","id":"perform-analysis-using-raw-instruments","dir":"Articles","previous_headings":"","what":"Perform analysis using raw instruments","title":"Tutorial","text":"perform inverse variance weighted fixed effects MR method within population across populations. Heterogeneity estimates generated evaluate population distinct association compared others. combined estimate across populations assumes effect drawn distribution assumption holds power improved combined information. see consistent assocation across ancestries. Note estimate slightly precisely estimated others combining similar estimates. can visualise estimates:","code":"x$cross_estimate() #> $coefficients #> # A tibble: 5 × 8 #>   pops  Estimate `Std. Error` `t value` `Pr(>|t|)`     Qj Qjpval   Qdf #>   <chr>    <dbl>        <dbl>     <dbl>      <dbl>  <dbl>  <dbl> <dbl> #> 1 All      0.350       0.0303     11.5    1.52e-29 3.14    0.371     3 #> 2 AFR      0.318       0.222       1.43   1.53e- 1 0.0203  0.887     1 #> 3 EAS      0.476       0.0784      6.07   1.62e- 9 2.60    0.107     1 #> 4 EUR      0.325       0.0342      9.52   6.61e-21 0.503   0.478     1 #> 5 SAS      0.366       0.142       2.58   9.98e- 3 0.0141  0.906     1 x$plot_cross_estimate()"},{"path":"/articles/tutorial.html","id":"perform-regional-scan-to-obtain-ld-agnostic-instruments","dir":"Articles","previous_headings":"","what":"Perform regional scan to obtain LD agnostic instruments","title":"Tutorial","text":"can re-select instruments scanning across region. intention allow populations contribute fixed effects meta analysis account LD. top variant region meta analysis used instrument populations. extracted regions around pooled instruments exposure dataset. Now can use either fixed effects meta analysis within region choose best SNP across ancestries. cases strongly associated SNPs available exactly position, function searches alternative SNPs located near original SNP show largest effect size magnitude. use Z-score based meta analysis unsure whether effect size scales sufficiently consistent across studies: Example  , European top hit LD many variants European ancestry, meta-analysing ancestries identified similarly strongly associated variant Europeans also strongly associated East Asians. used European top hit missed stronger association region associates ancestries . Note sample sizes SAS AFR studies small relatively underpowered throughout analysis.","code":"x$extract_instrument_regions() x$fema_regional_instruments() %>% str() #> tibble [1,492 × 13] (S3: tbl_df/tbl/data.frame) #>  $ beta    : num [1:1492] 0.0174 -0.0312 0.0144 0.012 0.0258 ... #>  $ n       : num [1:1492] NA NA 461460 NA NA ... #>  $ se      : num [1:1492] 0.01609 0.02562 0.00199 0.00422 0.01579 ... #>  $ position: int [1:1492] 2722848 2722848 2722848 2722848 6694927 6694927 6694927 6694927 11236410 11236410 ... #>  $ p       : num [1:1492] 2.80e-01 2.24e-01 5.10e-13 4.33e-03 1.02e-01 ... #>  $ chr     : chr [1:1492] \"1\" \"1\" \"1\" \"1\" ... #>  $ id      : chr [1:1492] \"ukb-e-23104_CSA\" \"ukb-e-21001_AFR\" \"ukb-b-19953\" \"bbj-a-1\" ... #>  $ rsid    : chr [1:1492] \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" ... #>  $ ea      : chr [1:1492] \"C\" \"C\" \"C\" \"C\" ... #>  $ nea     : chr [1:1492] \"T\" \"T\" \"T\" \"T\" ... #>  $ eaf     : num [1:1492] 0.285 0.141 0.534 0.565 0.286 ... #>  $ trait   : chr [1:1492] \"Body mass index (BMI)\" \"Body mass index (BMI)\" \"Body mass index (BMI)\" \"Body mass index\" ... #>  $ rsido   : chr [1:1492] \"rs6692145\" \"rs6692145\" \"rs6692145\" \"rs6692145\" ... x$fema_regional_instruments(method=\"zma\") %>% str() #> tibble [1,492 × 13] (S3: tbl_df/tbl/data.frame) #>  $ beta    : num [1:1492] 0.0174 -0.0312 0.0144 0.012 0.027 ... #>  $ n       : num [1:1492] NA NA 461460 NA NA ... #>  $ se      : num [1:1492] 0.01609 0.02562 0.00199 0.00422 0.01562 ... #>  $ position: int [1:1492] 2722848 2722848 2722848 2722848 6684906 6684906 6684906 6684906 11236410 11236410 ... #>  $ p       : num [1:1492] 2.80e-01 2.24e-01 5.10e-13 4.33e-03 8.35e-02 ... #>  $ chr     : chr [1:1492] \"1\" \"1\" \"1\" \"1\" ... #>  $ id      : chr [1:1492] \"ukb-e-23104_CSA\" \"ukb-e-21001_AFR\" \"ukb-b-19953\" \"bbj-a-1\" ... #>  $ rsid    : chr [1:1492] \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" ... #>  $ ea      : chr [1:1492] \"C\" \"C\" \"C\" \"C\" ... #>  $ nea     : chr [1:1492] \"T\" \"T\" \"T\" \"T\" ... #>  $ eaf     : num [1:1492] 0.285 0.141 0.534 0.565 0.298 ... #>  $ trait   : chr [1:1492] \"Body mass index (BMI)\" \"Body mass index (BMI)\" \"Body mass index (BMI)\" \"Body mass index\" ... #>  $ rsido   : chr [1:1492] \"rs6692145\" \"rs6692145\" \"rs6692145\" \"rs6692145\" ... x$plot_regional_instruments(names(x$instrument_regions)[3])"},{"path":"/articles/tutorial.html","id":"re-perform-analysis-using-regional-instruments","dir":"Articles","previous_headings":"","what":"Re-perform analysis using regional instruments","title":"Tutorial","text":"Note ’re now making copy x change x$outcome_outcome x$harmonised_dat objects reflect regional instrument selection. x R6 class object, need explicitly use x$clone() function create new copy. Now override harmonised data using regional instrument selection Re-harmonise newly extracted data Re-estimate MR associations using newly derived regional instruments precision associations improved improved instrument selection.  Evaluate instrument specificity. First using heterogeneity Compared agreement regression slopes much closer 1 ancestries. number apparently distinct instruments reduced also.","code":"x1 <- x$clone() x$make_outcome_data(exp=x$instrument_fema) x$harmonise(exp=x$instrument_fema) #> # A tibble: 4 × 4 #>   pops  exposure_ids    outcome_ids   source   #>   <chr> <chr>           <chr>         <chr>    #> 1 SAS   ukb-e-23104_CSA ukb-e-411_CSA OpenGWAS #> 2 AFR   ukb-e-21001_AFR ukb-e-411_AFR OpenGWAS #> 3 EUR   ukb-b-19953     ieu-a-7       OpenGWAS #> 4 EAS   bbj-a-1         bbj-a-109     OpenGWAS #> tibble [1,492 × 4] (S3: tbl_df/tbl/data.frame) #>  $ SNP : chr [1:1492] \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" ... #>  $ pops: chr [1:1492] \"SAS\" \"AFR\" \"EUR\" \"EAS\" ... #>  $ beta: num [1:1492] 0.0174 -0.0312 0.0144 0.012 0.027 ... #>  $ se  : num [1:1492] 0.01609 0.02562 0.00199 0.00422 0.01562 ... #> NULL #> 'data.frame':    2434 obs. of  4 variables: #>  $ SNP : chr  \"1:11207269_C_T\" \"1:11207269_C_T\" \"1:11207269_C_T\" \"1:11207269_C_T\" ... #>  $ pops: chr  \"SAS\" \"AFR\" \"EUR\" \"EAS\" ... #>  $ beta: num  -0.06663 -0.09457 -0.00328 0.0234 0.00391 ... #>  $ se  : num  0.0594 0.0809 0.0112 0.0319 0.0457 ... #> NULL #> tibble [1,487 × 6] (S3: tbl_df/tbl/data.frame) #>  $ SNP   : chr [1:1487] \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" \"1:2722848_C_T\" ... #>  $ pops  : chr [1:1487] \"SAS\" \"AFR\" \"EUR\" \"EAS\" ... #>  $ beta.x: num [1:1487] 0.0174 -0.0312 0.0144 0.012 0.027 ... #>  $ se.x  : num [1:1487] 0.01609 0.02562 0.00199 0.00422 0.01562 ... #>  $ beta.y: num [1:1487] -0.00619 -0.07145 0.00269 -0.01034 0.05529 ... #>  $ se.y  : num [1:1487] 0.05008 0.1119 0.00969 0.01632 0.04868 ... #> NULL x$cross_estimate() #> $coefficients #> # A tibble: 5 × 8 #>   pops  Estimate `Std. Error` `t value` `Pr(>|t|)`    Qj Qjpval   Qdf #>   <chr>    <dbl>        <dbl>     <dbl>      <dbl> <dbl>  <dbl> <dbl> #> 1 All      0.460       0.0291     15.8    3.94e-52 1.91   0.591     3 #> 2 AFR      0.379       0.193       1.96   4.97e- 2 0.176  0.675     1 #> 3 EAS      0.544       0.0712      7.65   3.69e-14 1.38   0.240     1 #> 4 EUR      0.448       0.0334     13.4    5.99e-39 0.131  0.718     1 #> 5 SAS      0.396       0.136       2.92   3.52e- 3 0.226  0.635     1 x$plot_cross_estimate() x$instrument_heterogeneity(x$instrument_fema) #> # A tibble: 6 × 9 #>   Reference  Replication  nsnp agreement     se      pval     I2      Q   Q_pval #>   <chr>      <chr>       <int>     <dbl>  <dbl>     <dbl>  <dbl>  <dbl>    <dbl> #> 1 ukb-b-199… ukb-e-2310…   370     0.685 0.0497 3.25e- 43 0.101   412.  6.21e- 2 #> 2 ukb-b-199… ukb-e-2100…   370     0.540 0.0781 4.58e- 12 0.305   533.  4.89e- 8 #> 3 ukb-b-199… bbj-a-1       370     0.689 0.0228 2.46e-200 0.680  1155.  9.07e-82 #> 4 bbj-a-1    ukb-e-2310…    59     0.809 0.0790 1.28e- 24 0.0275   60.7 3.80e- 1 #> 5 bbj-a-1    ukb-e-2100…    59     0.718 0.136  1.18e-  7 0.311    85.7 1.05e- 2 #> 6 bbj-a-1    ukb-b-19953    59     0.877 0.0353 3.64e-136 0.905   619.  7.37e-95 x$estimate_instrument_specificity(x$instrument_fema, alpha = \"bonferroni\") #> Checking ukb-e-23104_CSA against ukb-e-21001_AFR #> Checking ukb-e-23104_CSA against ukb-b-19953 #> Checking ukb-e-23104_CSA against bbj-a-1 #> Checking ukb-e-21001_AFR against ukb-e-23104_CSA #> Checking ukb-e-21001_AFR against ukb-b-19953 #> Checking ukb-e-21001_AFR against bbj-a-1 #> Checking ukb-b-19953 against ukb-e-23104_CSA #> Checking ukb-b-19953 against ukb-e-21001_AFR #> Checking ukb-b-19953 against bbj-a-1 #> Checking bbj-a-1 against ukb-e-23104_CSA #> Checking bbj-a-1 against ukb-e-21001_AFR #> Checking bbj-a-1 against ukb-b-19953 #>          discovery     replication nsnp  metric    datum       value #> 1  ukb-e-21001_AFR ukb-e-23104_CSA    1 P-value Expected   0.9987977 #> 2  ukb-e-21001_AFR ukb-e-23104_CSA    1 P-value Observed   1.0000000 #> 3  ukb-e-21001_AFR ukb-e-23104_CSA    1    Sign Expected   0.9999995 #> 4  ukb-e-21001_AFR ukb-e-23104_CSA    1    Sign Observed   1.0000000 #> 5  ukb-e-21001_AFR     ukb-b-19953    1 P-value Expected   1.0000000 #> 6  ukb-e-21001_AFR     ukb-b-19953    1 P-value Observed   1.0000000 #> 7  ukb-e-21001_AFR     ukb-b-19953    1    Sign Expected   0.9999995 #> 8  ukb-e-21001_AFR     ukb-b-19953    1    Sign Observed   1.0000000 #> 9  ukb-e-21001_AFR         bbj-a-1    1 P-value Expected   1.0000000 #> 10 ukb-e-21001_AFR         bbj-a-1    1 P-value Observed   1.0000000 #> 11 ukb-e-21001_AFR         bbj-a-1    1    Sign Expected   0.9999995 #> 12 ukb-e-21001_AFR         bbj-a-1    1    Sign Observed   1.0000000 #> 13     ukb-b-19953 ukb-e-23104_CSA  370 P-value Expected   1.8157266 #> 14     ukb-b-19953 ukb-e-23104_CSA  370 P-value Observed   2.0000000 #> 15     ukb-b-19953 ukb-e-23104_CSA  370    Sign Expected 309.1513616 #> 16     ukb-b-19953 ukb-e-23104_CSA  370    Sign Observed 267.0000000 #> 17     ukb-b-19953 ukb-e-21001_AFR  370 P-value Expected   0.3249830 #> 18     ukb-b-19953 ukb-e-21001_AFR  370 P-value Observed   1.0000000 #> 19     ukb-b-19953 ukb-e-21001_AFR  370    Sign Expected 280.3798398 #> 20     ukb-b-19953 ukb-e-21001_AFR  370    Sign Observed 224.0000000 #> 21     ukb-b-19953         bbj-a-1  370 P-value Expected 125.4393111 #> 22     ukb-b-19953         bbj-a-1  370 P-value Observed  57.0000000 #> 23     ukb-b-19953         bbj-a-1  370    Sign Expected 365.6500239 #> 24     ukb-b-19953         bbj-a-1  370    Sign Observed 326.0000000 #> 25         bbj-a-1 ukb-e-23104_CSA   59 P-value Expected   1.5690627 #> 26         bbj-a-1 ukb-e-23104_CSA   59 P-value Observed   2.0000000 #> 27         bbj-a-1 ukb-e-23104_CSA   59    Sign Expected  53.7020322 #> 28         bbj-a-1 ukb-e-23104_CSA   59    Sign Observed  49.0000000 #> 29         bbj-a-1 ukb-e-21001_AFR   59 P-value Expected   0.2168368 #> 30         bbj-a-1 ukb-e-21001_AFR   59 P-value Observed   1.0000000 #> 31         bbj-a-1 ukb-e-21001_AFR   59    Sign Expected  49.0352256 #> 32         bbj-a-1 ukb-e-21001_AFR   59    Sign Observed  40.0000000 #> 33         bbj-a-1     ukb-b-19953   59 P-value Expected  58.5784421 #> 34         bbj-a-1     ukb-b-19953   59 P-value Observed  56.0000000 #> 35         bbj-a-1     ukb-b-19953   59    Sign Expected  58.9999029 #> 36         bbj-a-1     ukb-b-19953   59    Sign Observed  59.0000000 #>           pdiff #> 1  1.000000e+00 #> 2  1.000000e+00 #> 3  1.000000e+00 #> 4  1.000000e+00 #> 5  1.000000e+00 #> 6  1.000000e+00 #> 7  1.000000e+00 #> 8  1.000000e+00 #> 9  1.000000e+00 #> 10 1.000000e+00 #> 11 1.000000e+00 #> 12 1.000000e+00 #> 13 7.044128e-01 #> 14 7.044128e-01 #> 15 3.380126e-08 #> 16 3.380126e-08 #> 17 2.775636e-01 #> 18 2.775636e-01 #> 19 1.129478e-10 #> 20 1.129478e-10 #> 21 1.525549e-15 #> 22 1.525549e-15 #> 23 7.530802e-30 #> 24 7.530802e-30 #> 25 6.713860e-01 #> 26 6.713860e-01 #> 27 4.016606e-02 #> 28 4.016606e-02 #> 29 1.952602e-01 #> 30 1.952602e-01 #> 31 4.477276e-03 #> 32 4.477276e-03 #> 33 8.803643e-03 #> 34 8.803643e-03 #> 35 1.000000e+00 #> 36 1.000000e+00 x$instrument_specificity$distinct %>% table #> . #> FALSE  TRUE  #>  1124   166"},{"path":"/articles/tutorial.html","id":"evaluate-similarity-of-pleiotropy-across-ancestry","dir":"Articles","previous_headings":"","what":"Evaluate similarity of pleiotropy across ancestry","title":"Tutorial","text":"Note: term pleiotropy used refers ‘horizontal pleiotropy’, influence SNP outcome mediated exposure. find pleiotropy outliers MR analysis, determine deviation outliers overall MR estimates consistent across populations Outliers detected based whether SNP’s Wald ratio (particular population) substantially different overall estimate. overall estimate combined meta-analysis across populations SNPs, unless population’s overall MR estimate contributed substantially heterogeneity. case, deviation estimated based population’s specific MR estimate. outliers population, populations showing similar deviation outlier discovery population? e.g. look whether sign outliers discovered Europeans: Look overall relationship outlier deviations across populations  Identify variants showed substantial differences pleiotropy deviations across populations. Note sometimes pleiotropy deviation estimate unstable due SNP-exposure association small. Unstable estimates attempted removed automatically heterogeneity analysis  SNPs showing substantial differences pleiotropy deviation across populations. Plot everything relaxing threshold","code":"x$pleiotropy() x$pleiotropy_outliers #> # A tibble: 36 × 16 #>    SNP         pops    beta.x    se.x   beta.y    se.y   pval.x  pval.y       wr #>    <chr>       <chr>    <dbl>   <dbl>    <dbl>   <dbl>    <dbl>   <dbl>    <dbl> #>  1 10:1049422… SAS    0.0154  0.0176   3.00e-2 0.0546  1.90e- 1 2.91e-1  1.95e+0 #>  2 10:1049422… AFR    0.0732  0.0867  -1.10e-5 0.385   1.99e- 1 5.00e-1 -1.50e-4 #>  3 10:1049422… EUR    0.0238  0.00370 -7.70e-2 0.0144  6.14e-11 4.69e-8 -3.24e+0 #>  4 10:1049422… EAS    0.0253  0.00423 -2.79e-2 0.0177  1.12e- 9 5.73e-2 -1.10e+0 #>  5 11:1331520… SAS    0.00115 0.0145  -4.07e-2 0.0453  4.68e- 1 1.84e-1 -3.55e+1 #>  6 11:1331520… AFR   -0.102   0.0381  -2.18e-2 0.168   3.81e- 3 4.49e-1  2.14e-1 #>  7 11:1331520… EUR    0.0164  0.00200  4.00e-2 0.00974 1.15e-16 2.00e-5  2.44e+0 #>  8 11:1331520… EAS    0.0103  0.00451  8.29e-3 0.0189  1.13e- 2 3.30e-1  8.06e-1 #>  9 11:1169473… SAS   -0.00940 0.0267  -7.18e-2 0.0830  3.62e- 1 1.93e-1  7.64e+0 #> 10 11:1169473… AFR   -0.0268  0.0327   1.15e-1 0.144   2.06e- 1 2.12e-1 -4.28e+0 #> # ℹ 26 more rows #> # ℹ 7 more variables: wr.se <dbl>, biv <dbl>, biv.se <dbl>, dif <dbl>, #> #   dif.se <dbl>, Qj <dbl>, Qjpval <dbl> x$pleiotropy_agreement %>% as.data.frame %>% subset(disc == \"EUR\" & metric==\"Sign\") #>    disc rep nsnp metric    datum    value      pdiff #> 15  EUR SAS    8   Sign Expected 6.142359 0.09065468 #> 16  EUR SAS    8   Sign Observed 4.000000 0.09065468 #> 19  EUR AFR    8   Sign Expected 5.737231 0.04563731 #> 20  EUR AFR    8   Sign Observed 3.000000 0.04563731 #> 23  EUR EAS    8   Sign Expected 7.397345 0.01794272 #> 24  EUR EAS    8   Sign Observed 5.000000 0.01794272 x$plot_pleiotropy() #> Joining with `by = join_by(pop1)` #> Joining with `by = join_by(pop2, SNP)` #> `geom_smooth()` using formula = 'y ~ x' x$plot_pleiotropy_heterogeneity(pthresh=0.05) x$plot_pleiotropy_heterogeneity(pthresh=1)"},{"path":"/articles/tutorial.html","id":"mr-gxe","dir":"Articles","previous_headings":"","what":"MR GxE","title":"Tutorial","text":"MR GxE model aims estimate horizontal pleiotropic effect SNP. achieved estimating effect outcome subset data SNP expected association (zero relevance group). cross-ancestry MR analysis can attempt make use approach identifying variants exhibit heterogeneity instrument-exposure association across ancestries. instruments can used estimate pleiotropic association evaluating effect outcome across populations showing differential SNP-exposure associations. First identify examples heterogeneity amongst instrument-exposure associations Next perform MR GxE (may take couple minutes bootstraping standard errors) distribution estimate pleiotropic effect SNP showed heterogeneity  evidence SNPs substantial heterogeneity? ’s worth always checking look credible e.g. plots SNP-exposure SNP-outcome associations identified SNPs. ’d expect see slope reflecting causal effect estimate intercept reflecting pleiotropic association.  case associations noisy, difficult justify show convincing evidence pleiotropy estimate.","code":"x$estimate_instrument_heterogeneity_per_variant() #> # A tibble: 373 × 5 #> # Groups:   SNP [373] #>    SNP                Qdf      Q    Qpval     Qfdr #>    <chr>            <dbl>  <dbl>    <dbl>    <dbl> #>  1 10:104942244_G_T     3  0.650 0.885    0.885    #>  2 10:118650996_C_T     3 17.7   0.000502 0.000502 #>  3 10:134007008_A_C     3  8.12  0.0436   0.0436   #>  4 10:16750129_G_T      3  0.510 0.917    0.917    #>  5 10:18573654_A_G      3  6.63  0.0847   0.0847   #>  6 10:21830104_A_G      3  3.19  0.363    0.363    #>  7 10:33955430_C_T      3 13.5   0.00375  0.00375  #>  8 10:53673286_A_G      3  4.26  0.235    0.235    #>  9 10:61842645_C_T      3  6.16  0.104    0.104    #> 10 10:65191645_G_T      3  0.621 0.892    0.892    #> # ℹ 363 more rows x$instrument_heterogeneity_per_variant %>% dplyr::filter(Qfdr < 0.05) #> # A tibble: 95 × 5 #> # Groups:   SNP [95] #>    SNP                Qdf     Q      Qpval       Qfdr #>    <chr>            <dbl> <dbl>      <dbl>      <dbl> #>  1 10:118650996_C_T     3 17.7  0.000502   0.000502   #>  2 10:134007008_A_C     3  8.12 0.0436     0.0436     #>  3 10:33955430_C_T      3 13.5  0.00375    0.00375    #>  4 10:87490850_A_G      3  8.51 0.0365     0.0365     #>  5 10:99772885_A_G      3 18.8  0.000298   0.000298   #>  6 11:130795698_G_T     3 14.5  0.00232    0.00232    #>  7 11:13315205_C_T      3 11.9  0.00786    0.00786    #>  8 11:2858440_A_G       3 29.5  0.00000179 0.00000179 #>  9 11:43648368_G_T      3 12.4  0.00627    0.00627    #> 10 11:45420233_A_G      3  8.59 0.0352     0.0352     #> # ℹ 85 more rows x$mrgxe() #> # A tibble: 95 × 9 #> # Groups:   SNP [95] #>    SNP                      a       b   a_se  b_se a_pval b_pval   a_mean b_mean #>    <chr>                <dbl>   <dbl>  <dbl> <dbl>  <dbl>  <dbl>    <dbl>  <dbl> #>  1 10:118650996_C_T   4.50e-2  2.14   0.0257  1.99 0.0398 0.140   5.11e-2  2.12  #>  2 10:134007008_A_C   3.26e-3  0.805  0.0272  2.13 0.452  0.353   1.98e-3  0.482 #>  3 10:33955430_C_T    6.10e-3 -0.195  0.0374  1.70 0.435  0.454   1.04e-2 -0.349 #>  4 10:87490850_A_G   -1.94e-2 -0.0305 0.0437  1.82 0.329  0.493  -2.79e-2 -0.218 #>  5 10:99772885_A_G   -1.95e-2 -1.48   0.0268  1.77 0.233  0.202  -2.39e-2 -1.45  #>  6 11:130795698_G_T  -1.10e-2  2.17   0.0232  1.46 0.318  0.0686 -9.49e-3  1.96  #>  7 11:13315205_C_T    1.68e-3  0.283  0.0261  1.89 0.474  0.441   2.00e-4  0.364 #>  8 11:2858440_A_G    -8.48e-2  1.42   0.114   3.08 0.229  0.322  -7.73e-2  0.845 #>  9 11:43648368_G_T    1.64e-2  1.53   0.0309  1.74 0.298  0.190   1.12e-2  0.965 #> 10 11:45420233_A_G    1.75e-5 -0.248  0.0374  2.43 0.500  0.459  -1.08e-2  0.406 #> # ℹ 85 more rows x$mrgxe_res #> # A tibble: 95 × 9 #> # Groups:   SNP [95] #>    SNP                      a       b   a_se  b_se a_pval b_pval   a_mean b_mean #>    <chr>                <dbl>   <dbl>  <dbl> <dbl>  <dbl>  <dbl>    <dbl>  <dbl> #>  1 10:118650996_C_T   4.50e-2  2.14   0.0257  1.99 0.0398 0.140   5.11e-2  2.12  #>  2 10:134007008_A_C   3.26e-3  0.805  0.0272  2.13 0.452  0.353   1.98e-3  0.482 #>  3 10:33955430_C_T    6.10e-3 -0.195  0.0374  1.70 0.435  0.454   1.04e-2 -0.349 #>  4 10:87490850_A_G   -1.94e-2 -0.0305 0.0437  1.82 0.329  0.493  -2.79e-2 -0.218 #>  5 10:99772885_A_G   -1.95e-2 -1.48   0.0268  1.77 0.233  0.202  -2.39e-2 -1.45  #>  6 11:130795698_G_T  -1.10e-2  2.17   0.0232  1.46 0.318  0.0686 -9.49e-3  1.96  #>  7 11:13315205_C_T    1.68e-3  0.283  0.0261  1.89 0.474  0.441   2.00e-4  0.364 #>  8 11:2858440_A_G    -8.48e-2  1.42   0.114   3.08 0.229  0.322  -7.73e-2  0.845 #>  9 11:43648368_G_T    1.64e-2  1.53   0.0309  1.74 0.298  0.190   1.12e-2  0.965 #> 10 11:45420233_A_G    1.75e-5 -0.248  0.0374  2.43 0.500  0.459  -1.08e-2  0.406 #> # ℹ 85 more rows x$mrgxe_plot() x$mrgxe_res %>% dplyr::filter(p.adjust(a_pval, \"fdr\") < 0.05) #> # A tibble: 6 × 9 #> # Groups:   SNP [6] #>   SNP                    a       b   a_se  b_se  a_pval b_pval  a_mean b_mean #>   <chr>              <dbl>   <dbl>  <dbl> <dbl>   <dbl>  <dbl>   <dbl>  <dbl> #> 1 10:118650996_C_T  0.0450  2.14   0.0257  1.99 0.0398  0.140   0.0511  2.12  #> 2 13:58259492_A_C  -0.0804 -4.47   0.0416  3.16 0.0266  0.0782 -0.0737 -2.60  #> 3 16:76895693_A_G   0.0567  2.19   0.0288  2.47 0.0247  0.188   0.0555  1.89  #> 4 19:33953354_G_T  -0.0681 -0.0869 0.0241  1.81 0.00233 0.481  -0.0635  0.121 #> 5 3:48118703_C_T    0.0406  1.42   0.0228  2.65 0.0373  0.297   0.0368  0.630 #> 6 9:28418511_A_G    0.0835 -3.03   0.0397  1.84 0.0178  0.0498  0.0817 -2.90 x$mrgxe_plot_variant() #> `geom_smooth()` using formula = 'y ~ x'"},{"path":"/articles/tutorial.html","id":"saving-and-loading-data","dir":"Articles","previous_headings":"","what":"Saving and loading data","title":"Tutorial","text":"can useful import data one CAMERA object another, example may data, CAMERA class updated, want initialise new class import old data new class. Save CAMERA objects RDS files e.g. load like : can import data one CAMERA object another like :","code":"saveRDS(x, file=\"example-CAMERA.rds\") x <- readRDS(file=\"example-CAMERA.rds\")"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yoonsu Cho. Author. Gibran Hemani. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cho Y, Hemani G (2024). CAMeRa: CAMeRa (Cross Ancestral Mendelian Randomisation). R package version 0.1.0.","code":"@Manual{,   title = {CAMeRa: CAMeRa (Cross Ancestral Mendelian Randomisation)},   author = {Yoonsu Cho and Gibran Hemani},   year = {2024},   note = {R package version 0.1.0}, }"},{"path":"/index.html","id":"cross-ancestry-mendelian-randomisation","dir":"","previous_headings":"","what":"CAMeRa (Cross Ancestral Mendelian Randomisation)","title":"CAMeRa (Cross Ancestral Mendelian Randomisation)","text":"goal CAMeRa estimate causal effects using summary statistics multiple ancestries. CAMeRa provides: Selecting genetic instruments multiple populations. Estimating causal effect exposure outcome summary statistics different ancestral populations. Jointly modelling causal pleiotropic effects across multiple populations.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"CAMeRa (Cross Ancestral Mendelian Randomisation)","text":"can install released / development version CAMeRa GitHub :","code":"install.packages(\"remotes\") remotes::install_github(\"universe77/CAMERA\")"},{"path":"/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"CAMeRa (Cross Ancestral Mendelian Randomisation)","text":"See vignettes examples","code":""},{"path":"/reference/CAMERA.html","id":null,"dir":"Reference","previous_headings":"","what":"R6 class for CAMERA — CAMERA","title":"R6 class for CAMERA — CAMERA","text":"simple wrapper function. Using summary set, identify set instruments traits, peform SEM MR test association across population.","code":""},{"path":[]},{"path":"/reference/CAMERA.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"R6 class for CAMERA — CAMERA","text":"CAMERA$import() CAMERA$assign() CAMERA$import_from_local() CAMERA$new() CAMERA$instrument_heterogeneity() CAMERA$estimate_instrument_specificity() CAMERA$replication_evaluation() CAMERA$check_phenotypes() CAMERA$cross_estimate() CAMERA$plot_cross_estimate() CAMERA$extract_instruments() CAMERA$extract_instrument_regions() CAMERA$scan_regional_instruments() CAMERA$plot_regional_instruments_maxz() CAMERA$regional_ld_matrices() CAMERA$susie_finemap_regions() CAMERA$paintor_finemap_regions() CAMERA$MsCAVIAR_finemap_regions() CAMERA$fema_regional_instruments() CAMERA$plot_regional_instruments() CAMERA$get_metadata() CAMERA$estimate_instrument_heterogeneity_per_variant() CAMERA$mrgxe() CAMERA$mrgxe_plot() CAMERA$mrgxe_plot_variant() CAMERA$make_outcome_data() CAMERA$harmonise_deprecated() CAMERA$harmonise() CAMERA$set_summary() CAMERA$pleiotropy() CAMERA$plot_pleiotropy() CAMERA$plot_pleiotropy_heterogeneity() CAMERA$pleiotropy_deprecated() CAMERA$pleiotropy_specificity_deprecated() CAMERA$perform_basic_sem() CAMERA$runsem() CAMERA$standardise_data() CAMERA$clone()","code":""},{"path":"/reference/CAMERA.html","id":"method-import-","dir":"Reference","previous_headings":"","what":"Method import()","title":"R6 class for CAMERA — CAMERA","text":"Migrate results previous CAMERA","code":""},{"path":"/reference/CAMERA.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$import(x)"},{"path":"/reference/CAMERA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for CAMERA — CAMERA","text":"x R6 Environment created CAMERA. Default = x","code":""},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$assign(...)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$import_from_local(   instrument_raw,   instrument_outcome,   instrument_regions,   instrument_outcome_regions,   exposure_ids,   outcome_ids,   ... )"},{"path":"/reference/CAMERA.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"R6 class for CAMERA — CAMERA","text":"Create new dataset initialise R interface","code":""},{"path":"/reference/CAMERA.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$new(   exposure_ids = NULL,   outcome_ids = NULL,   pops = NULL,   bfiles = NULL,   plink = NULL,   radius = NULL,   clump_pop = NULL,   x = NULL )"},{"path":"/reference/CAMERA.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for CAMERA — CAMERA","text":"exposure_ids Exposures IDs obtained IEU GWAS database (https://gwas.mrcieu.ac.uk/) population outcome_ids Outcome IDs obtained IEU GWAS database (https://gwas.mrcieu.ac.uk/) population pops Ancestry information population (.e. AFR, AMR, EUR, EAS, SAS) bfiles Locations LD reference files population (Download : http://fileserve.mrcieu.ac.uk/ld/1kg.v3.tgz) plink Location executable plink (ver.1.90 recommended) radius Genomic window size extract SNPs clump_pop Reference population clumping x Import data available","code":""},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$instrument_heterogeneity(   instrument = self$instrument_raw,   alpha = \"bonferroni\",   method = \"ivw\",   outlier_removal = FALSE )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$estimate_instrument_specificity(   instrument,   alpha = \"bonferroni\",   winnerscurse = FALSE )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$replication_evaluation(   instrument = self$instrument_raw,   ld = self$ld_matrices )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$check_phenotypes(ids = self$exposure_ids)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$cross_estimate(dat = self$harmonised_dat)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$plot_cross_estimate(res = self$mrres, qj_alpha = 0.05)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$extract_instruments(exposure_ids = self$exposure_ids, ...)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$extract_instrument_regions(   radius = self$radius,   instrument_raw = self$instrument_raw,   exposure_ids = self$exposure_ids )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$scan_regional_instruments(   instrument_raw = self$instrument_raw,   instrument_regions = self$instrument_regions )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$plot_regional_instruments_maxz(   instrument_region_zscores = self$instrument_region_zscores,   instruments = self$instrument_raw,   region = 1:min(10, nrow(instruments)),   comparison = FALSE )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$regional_ld_matrices(   instrument_regions = self$instrument_regions,   bfiles = self$bfiles,   pops = self$pops,   plink = self$plink )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$susie_finemap_regions(   dat = self$instrument_regions,   ld = self$ld_matrices )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-16","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$paintor_finemap_regions(   region = self$instrument_regions,   ld = self$ld_matrices,   PAINTOR = \"PAINTOR\",   workdir = tempdir() )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-17","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$MsCAVIAR_finemap_regions(   region = self$instrument_regions,   ld = self$ld_matrices,   MsCAVIAR = \"MsCAVIAR\",   workdir = tempdir() )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-18","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$fema_regional_instruments(   method = \"fema\",   instrument_regions = self$instrument_regions,   instrument_raw = self$instrument_raw,   n = self$exposure_metadata$sample_size )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-19","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$plot_regional_instruments(   region,   instrument_regions = self$instrument_regions,   meta_analysis_regions = self$instrument_fema_regions )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-20","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$get_metadata(   exposure_ids = self$exposure_ids,   outcome_ids = self$outcome_ids )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-21","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$estimate_instrument_heterogeneity_per_variant(dat = self$harmonised_dat)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-22","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$mrgxe(   dat = self$harmonised_dat,   variant_list = subset(self$instrument_heterogeneity_per_variant, Qfdr < 0.05)$SNP,   nboot = 100 )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-23","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$mrgxe_plot(mrgxe_res = self$mrgxe_res)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-24","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$mrgxe_plot_variant(   variant = self$mrgxe_res %>% dplyr::filter(p.adjust(a_pval, \"fdr\") < 0.05) %>% {          .$SNP  },   dat = self$harmonised_dat )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-25","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$make_outcome_data(exp = self$instrument_raw, p_exp = 0.05/nrow(exp))"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-26","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$harmonise_deprecated(   exp = self$instrument_raw,   out = self$instrument_outcome )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-27","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$harmonise(exp = self$instrument_raw, out = self$instrument_outcome)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-28","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$set_summary()"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-29","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$pleiotropy(harmonised_dat = self$harmonised_dat)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-30","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$plot_pleiotropy(dat = self$pleiotropy_outliers)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-31","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$plot_pleiotropy_heterogeneity(   dat = self$pleiotropy_Q_outliers,   pthresh = 0.05 )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-32","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$pleiotropy_deprecated(harmonised_dat = self$harmonised_dat_sem)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-33","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$pleiotropy_specificity_deprecated(   harmonised_dat = self$harmonised_dat_sem,   sem_result = self$sem_result,   pleioropy = self$pleiotropy_dat )"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-34","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$perform_basic_sem(harmonised_dat = self$harmonised_dat_sem)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-35","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$runsem(model, data, modname)"},{"path":[]},{"path":"/reference/CAMERA.html","id":"usage-36","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$standardise_data(   dat = self$instrument_raw,   standardise_unit = FALSE,   standardise_scale = FALSE,   scaling_method = \"simple_mode\" )"},{"path":"/reference/CAMERA.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"R6 class for CAMERA — CAMERA","text":"objects class cloneable method.","code":""},{"path":"/reference/CAMERA.html","id":"usage-37","dir":"Reference","previous_headings":"","what":"Usage","title":"R6 class for CAMERA — CAMERA","text":"","code":"CAMERA$clone(deep = FALSE)"},{"path":"/reference/CAMERA.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"R6 class for CAMERA — CAMERA","text":"deep Whether make deep clone.","code":""},{"path":"/reference/CAMERA_local.html","id":null,"dir":"Reference","previous_headings":"","what":"CAMERA_local class — CAMERA_local","title":"CAMERA_local class — CAMERA_local","text":"simple wrapper function importing data local files use CAMERA class.","code":""},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"CAMERA_local class — CAMERA_local","text":"CAMERA_local$new() CAMERA_local$standardise() CAMERA_local$read_file() CAMERA_local$pool_tophits() CAMERA_local$organise_data() CAMERA_local$fixed_effects_meta_analysis_fast() CAMERA_local$organise() CAMERA_local$clone()","code":""},{"path":"/reference/CAMERA_local.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"CAMERA_local class — CAMERA_local","text":"Create new dataset initialise R interface","code":""},{"path":"/reference/CAMERA_local.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$new(   metadata,   ld_ref,   plink_bin,   mc.cores = 1,   radius = 25000,   pthresh = 5e-08,   minmaf = 0.01 )"},{"path":"/reference/CAMERA_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CAMERA_local class — CAMERA_local","text":"metadata Data frame information data. One row per dataset. See details info columns ld_ref Data frame two columns - pop = population (referencing pop values metadata), bfile = path plink file reference plink_bin Location executable plink (ver.1.90 recommended) radius Genomic window size extract SNPs pthresh P-value threshold instrument inclusion minmaf Minimum allelel frequency per dataset clump_pop Reference population clumping","code":""},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$standardise(   d,   ea_col = \"ea\",   oa_col = \"oa\",   beta_col = \"beta\",   eaf_col = \"eaf\",   chr_col = \"chr\",   pos_col = \"pos\",   vid_col = \"vid\" )"},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$read_file(m, minmaf = 0.01)"},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$pool_tophits(   rawdat,   tophits,   metadata,   radius = 250000,   pthresh = 5e-08,   mc.cores = 10 )"},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$organise_data(   metadata = self$metadata,   plink_bin = self$plink_bin,   ld_ref = self$ld_ref,   pthresh = self$pthresh,   minmaf = self$minmaf,   radius = self$radius,   mc.cores = self$mc.cores )"},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$fixed_effects_meta_analysis_fast(beta_mat, se_mat)"},{"path":[]},{"path":"/reference/CAMERA_local.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$organise()"},{"path":"/reference/CAMERA_local.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"CAMERA_local class — CAMERA_local","text":"objects class cloneable method.","code":""},{"path":"/reference/CAMERA_local.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"CAMERA_local class — CAMERA_local","text":"","code":"CAMERA_local$clone(deep = FALSE)"},{"path":"/reference/CAMERA_local.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"CAMERA_local class — CAMERA_local","text":"deep Whether make deep clone.","code":""},{"path":"/reference/egger_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform MR GxE — egger_bootstrap","title":"Perform MR GxE — egger_bootstrap","text":"single variant estiamted different sub groups.","code":""},{"path":"/reference/egger_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform MR GxE — egger_bootstrap","text":"","code":"egger_bootstrap(b_gx, se_gx, b_gy, se_gy, nboot = 1000)"},{"path":"/reference/egger_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform MR GxE — egger_bootstrap","text":"b_gx Vector instrument-exposure associations, one sub group se_gx Vector standard errors b_gx b_gy Vector instrument-outcome associations, one sub group se_gy Vector standard errors b_gy nboot Number bootstraps. Default=1000","code":""},{"path":"/reference/egger_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform MR GxE — egger_bootstrap","text":"List = intercept estimate (pleiotropy) b = slope estimate (b_iv effect) a_se = standard error intercept b_se = standard error slope a_pval = p-value intercept estimate b_pval = p-value slope estimate a_mean = mean value intercept bootstraps b_mean = mean value slope estimates bootstraps","code":""},{"path":"/reference/egger_bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform MR GxE — egger_bootstrap","text":"Estimate degree pleiotropy using MR GxE. method uses negative control type approach based assumption instrument-exposure association uncorrelated pleiotropic effect. Therefore, instrument-exposure association reduces magnitude, effect outcome reduce towards intercept term represents pleiotropic effect. Standard errors obtained parametric bootstrap","code":""},{"path":"/reference/fixed_effects_meta_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform fixed effects meta analysis for one association — fixed_effects_meta_analysis","title":"Perform fixed effects meta analysis for one association — fixed_effects_meta_analysis","text":"Perform fixed effects meta analysis one association","code":""},{"path":"/reference/fixed_effects_meta_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform fixed effects meta analysis for one association — fixed_effects_meta_analysis","text":"","code":"fixed_effects_meta_analysis(beta_vec, se_vec, infl = 10000)"},{"path":"/reference/fixed_effects_meta_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform fixed effects meta analysis for one association — fixed_effects_meta_analysis","text":"infl Inflation factor - much larger estimate estimate tightest SE - use removing unreliable estimates","code":""},{"path":"/reference/fixed_effects_meta_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform fixed effects meta analysis for one association — fixed_effects_meta_analysis","text":"list results","code":""},{"path":"/reference/fixed_effects_meta_analysis_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Fixed effects meta analysis vectorised across multiple SNPs — fixed_effects_meta_analysis_fast","title":"Fixed effects meta analysis vectorised across multiple SNPs — fixed_effects_meta_analysis_fast","text":"Assumes effects across studies scale","code":""},{"path":"/reference/fixed_effects_meta_analysis_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fixed effects meta analysis vectorised across multiple SNPs — fixed_effects_meta_analysis_fast","text":"","code":"fixed_effects_meta_analysis_fast(beta_mat, se_mat)"},{"path":"/reference/fixed_effects_meta_analysis_fast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fixed effects meta analysis vectorised across multiple SNPs — fixed_effects_meta_analysis_fast","text":"beta_mat Matrix betas - rows SNPs, columns studies se_mat Matrix SEs - rows SNPs, columns studies","code":""},{"path":"/reference/fixed_effects_meta_analysis_fast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fixed effects meta analysis vectorised across multiple SNPs — fixed_effects_meta_analysis_fast","text":"list meta analysis betas SEs","code":""},{"path":"/reference/identify_blownup_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify blown up estimates — identify_blownup_estimates","title":"Identify blown up estimates — identify_blownup_estimates","text":"Sometimes estimates appear unstable. likely unreliable best use heterogeneity analyses etc.","code":""},{"path":"/reference/identify_blownup_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify blown up estimates — identify_blownup_estimates","text":"","code":"identify_blownup_estimates(b, se, infl)"},{"path":"/reference/identify_blownup_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify blown up estimates — identify_blownup_estimates","text":"b Vector betas se Vector SEs infl Inflation factor - much larger estimate estimate tightest SE","code":""},{"path":"/reference/identify_blownup_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify blown up estimates — identify_blownup_estimates","text":"index betas remove","code":""},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/prop_overlap.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate expected vs observed replication of effects between discovery and replication datasets — prop_overlap","title":"Estimate expected vs observed replication of effects between discovery and replication datasets — prop_overlap","text":"Taken Okbay et al 2016. assumption discovery effects unbiased, fraction associations replicate replication dataset, given differential power discovery replication datasets. Uses standard error replication dataset account differences sample size distribution independent variable","code":""},{"path":"/reference/prop_overlap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate expected vs observed replication of effects between discovery and replication datasets — prop_overlap","text":"","code":"prop_overlap(b_disc, b_rep, se_disc, se_rep, alpha)"},{"path":"/reference/prop_overlap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate expected vs observed replication of effects between discovery and replication datasets — prop_overlap","text":"b_disc Vector discovery betas b_rep Vector replication betas se_disc Vector discovery standard errors se_rep Vector replication standard errors alpha Nominal replication significance threshold","code":""},{"path":"/reference/prop_overlap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate expected vs observed replication of effects between discovery and replication datasets — prop_overlap","text":"List results res: aggregate expected replication rate vs observed replication rate variants: per variant expected replication rates","code":""},{"path":"/reference/z_meta_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"P-value based meta analysis — z_meta_analysis","title":"P-value based meta analysis — z_meta_analysis","text":"Uses weighted Z scores following advice https://onlinelibrary.wiley.com/doi/full/10.1111/j.1420-9101.2005.00917.x Suggested weights 1/se^2 However se scale dependent ideal avoid scale issues stage using instead calculate expected se based n af. Assumes continuous traits way uses n (.e. case control aware moment)","code":""},{"path":"/reference/z_meta_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-value based meta analysis — z_meta_analysis","text":"","code":"z_meta_analysis(beta_mat, se_mat, n, eaf_mat)"},{"path":"/reference/z_meta_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-value based meta analysis — z_meta_analysis","text":"beta_mat Matrix betas - rows SNPs, columns studies se_mat Matrix SEs - rows SNPs, columns studies n Vector sample sizes eaf_mat Matrix allele frequencies - rows SNPs, columns studies","code":""}]
